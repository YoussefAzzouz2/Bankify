{% extends 'backbase.html.twig' %}

{% block title %}<title>Catégories</title>{% endblock %}

{% block content %}
<style>
    .btn {
        display: inline-block;
        background-color: #007bff;
        color: white;
        padding: 6px 12px;
        text-align: center;
        text-decoration: none;
        border: none;
        border-radius: 3px;
        cursor: pointer;
        transition: background-color 0.3s;
        margin-right: 5px;
    }
    
    .btn-info {
        background-color: #17a2b8;
    }
    
    .btn-primary {
        background-color: #007bff;
    }
    
    .btn-success {
        background-color: #28a745;
    }
    
    .btn-danger {
        background-color: #dc3545;
    }
    
    .btn:hover {
        background-color: #0056b3;
    }
    
</style>
<table class="table table-striped">
    <thead>
        <tr>
            <th scope="col">Id Catégorie</th>
            <th scope="col">Nom</th>
            <th scope="col">Montant Minimal</th>
            <th scope="col">Montant Maximal</th>
            <th scope="col">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for categorie_credit in categorie_credits %}
        <tr>
            <td>{{ categorie_credit.id }}</td>
            <td>{{ categorie_credit.nom }}</td>
            <td>{{ categorie_credit.minMontant }}</td>
            <td>{{ categorie_credit.maxMontant }}</td>
            <td>
                <button class="btn btn-sm btn-info" onclick="window.location.href='{{ path('categorie_show', {'id': categorie_credit.id}) }}'">Détails</button>
                <button class="btn btn-sm btn-primary" onclick="window.location.href='{{ path('categorie_edit', {'id': categorie_credit.id}) }}'">Modifier</button>
                {{ include('categorie_credit/_delete_form.html.twig') }}
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="5">Pas de catégorie</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<button class="btn btn-success" onclick="window.location.href='{{ path('categorie_new') }}'">Ajouter une nouvelle catégorie</button>

<canvas id="pieChart"></canvas>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
<script>
    const statistiques = {{ statistiques|json_encode|raw }};
    
    const labels = statistiques.map(statistique => statistique.categorie);
    const counts = statistiques.map(statistique => statistique.nombreCredits);

    const ctx = document.getElementById('pieChart');

    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: counts,
                backgroundColor: [
                    'rgba(255, 99, 132, 0.5)',
                    'rgba(54, 162, 235, 0.5)',
                    'rgba(255, 206, 86, 0.5)',
                    'rgba(75, 192, 192, 0.5)',
                    'rgba(153, 102, 255, 0.5)',
                    'rgba(255, 159, 64, 0.5)',
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)',
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            legend: {
                position: 'top',
            },
            title: {
                display: true,
                text: 'Statistiques des catégories'
            }
        }
    });
</script>

{% endblock %}